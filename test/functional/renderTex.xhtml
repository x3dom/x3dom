<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
	<meta http-equiv='Content-Type' content='text/html;charset=utf-8'/>
	<title>renderTex.xhtml</title>

    <!-- BEGIN:X3DOM -->
<link rel="stylesheet" type="text/css" href="../../src/x3dom.css" />
<script type="text/javascript" src="../../src/lang/Array.js"></script>
<script type="text/javascript" src="../../src/Internals.js"></script>
<script type="text/javascript" src="../../src/debug.js"></script>
<script type="text/javascript" src="../../src/ImageLoadManager.js"></script>
<script type="text/javascript" src="../../src/lang/Properties.js"></script>
<script type="text/javascript" src="../../src/X3DCanvas.js"></script>
<script type="text/javascript" src="../../src/Runtime.js"></script>
<script type="text/javascript" src="../../src/Main.js"></script>
<script type="text/javascript" src="../../src/gfx_webgl.js"></script>
<script type="text/javascript" src="../../src/gfx_flash.js"></script>
<script type="text/javascript" src="../../src/X3DDocument.js"></script>
<script type="text/javascript" src="../../src/MatrixMixer.js"></script>
<script type="text/javascript" src="../../src/Viewarea.js"></script>
<script type="text/javascript" src="../../src/Mesh.js"></script>
<script type="text/javascript" src="../../src/fields.js"></script>
<script type="text/javascript" src="../../src/nodes/NodeNameSpace.js"></script>
<script type="text/javascript" src="../../src/nodes/Core.js"></script>
<script type="text/javascript" src="../../src/nodes/Grouping.js"></script>
<script type="text/javascript" src="../../src/nodes/Bindable.js"></script>
<script type="text/javascript" src="../../src/nodes/Rendering.js"></script>
<script type="text/javascript" src="../../src/nodes/Shape.js"></script>
<script type="text/javascript" src="../../src/nodes/Lighting.js"></script>
<script type="text/javascript" src="../../src/nodes/Followers.js"></script>
<script type="text/javascript" src="../../src/nodes/Interpolation.js"></script>
<script type="text/javascript" src="../../src/nodes/Time.js"></script>
<script type="text/javascript" src="../../src/nodes/Networking.js"></script>
<script type="text/javascript" src="../../src/nodes/EnvironmentalEffects.js"></script>
<script type="text/javascript" src="../../src/nodes/Navigation.js"></script>
<script type="text/javascript" src="../../src/nodes/Text.js"></script>
<script type="text/javascript" src="../../src/nodes/Sound.js"></script>
<script type="text/javascript" src="../../src/nodes/Texturing.js"></script>
<script type="text/javascript" src="../../src/nodes/Shaders.js"></script>
<script type="text/javascript" src="../../src/nodes/Geometry3D.js"></script>
<script type="text/javascript" src="../../src/nodes/Geometry2D.js"></script>
<script type="text/javascript" src="../../src/nodes/Geospatial.js"></script>
<!-- END:X3DOM -->

    <!-- BEGIN:TEST -->
    <script type="text/javascript" src="media/js/tests.js"></script>
    <!-- END:TEST -->

    
</head>
<body>
	<h1>Render Texture</h1>
    
	<div class="group">
    <X3D xmlns='http://www.web3d.org/specifications/x3d-namespace' id='someUniqueId' showStat='true' showLog='true' width='512px' height='512px'>
      <Scene DEF='scene'>
        <Viewpoint id='view1' position='0 0 12'/>
        <Background id='back' 
            backUrl="media/texture/generic/ocean_3_back.jpg"
            bottomUrl="media/texture/generic/ocean_3_bottom.jpg"
            frontUrl="media/texture/generic/ocean_3_front.jpg"
            leftUrl="media/texture/generic/ocean_3_left.jpg"
            rightUrl="media/texture/generic/ocean_3_right.jpg"
            topUrl="media/texture/generic/ocean_3_top.jpg"
            skyAngle='0.9 1.5 1.57' skyColor='0.21 0.18 0.66 0.2 0.44 0.85 0.51 0.81 0.95 0.77 0.8 0.82' 
            groundAngle='0.9 1.5 1.57' groundColor='0.6 0.7 0.1 0.4 0.7 0.2 0.1 0.6 0.1 0 0.3 0.1'
        />
        <Transform DEF='trans1' translation='-2 2 0'>
          <Shape DEF='GEO'>
            <Appearance>
              <ImageTexture repeatS='false' repeatT='false' url='"media/texture/generic/crate.gif"'/>
            </Appearance>
            <Box />
          </Shape>
        </Transform>
        <Transform DEF='trans2' translation='2 2 0'>
          <Shape USE='GEO'/>
        </Transform>
        <Transform DEF='trans3' translation='-2 -2 0'>
          <Shape USE='GEO'/>
        </Transform>
        <Transform DEF='trans4' translation='2 -2 0'>
          <Shape USE='GEO'/>
        </Transform>
        <Transform DEF='trans' translation='0 0 -10'>
          <Transform DEF='matTrans'>
            <Shape DEF='aNode'>
              <IndexedFaceSet solid="false" coordIndex='0 1 2 3 -1'>
                <Coordinate point='-4 -4 0, 4 -4 0, 4 4 0, -4 4 0'/>
                <TextureCoordinate point='1 1 0 1 0 0 1 0'/>
              </IndexedFaceSet>
              <Appearance DEF='rtApp'>
                <RenderedTexture DEF='FBO' update='always' dimensions='512 512 4' repeatS='false' repeatT='false'>
                  <Shape USE='aNode' containerField='excludeNodes'/>
                  <Background USE='back' containerField='background'/>
                  <Viewpoint id='view2' containerField='viewpoint'
                             position="0 0 -20" orientation="0 1 0 3.1415926" />
                  <Group>
                     <Shape DEF="sphereShape">
						<Appearance>
							<Material diffuseColor="1 0 0" specularColor=".5 .5 .5" />
						</Appearance>
						<Sphere />
				     </Shape>
                     <Transform DEF='transRT' translation='4 0 0'>
                        <Shape USE='GEO'/>
                     </Transform>
                  </Group>
                </RenderedTexture>
              </Appearance>
            </Shape>
          </Transform>
        </Transform>
        <TimeSensor DEF='ts' cycleInterval='10' loop='true' startTime='1'/>
        <OrientationInterpolator DEF='oi' key='0 0.25 0.5 0.75 1' keyValue='0 1 1 0 0 1 1 1.57 0 1 1 3.14 0 1 1 4.71 0 1 1 6.28'/>
        <ROUTE fromNode='ts' fromField='fraction_changed' toNode='oi' toField='set_fraction'/>
        <ROUTE fromNode='oi' fromField='value_changed' toNode='trans4' toField='set_rotation'/>
        <ROUTE fromNode='oi' fromField='value_changed' toNode='trans3' toField='set_rotation'/>
        <ROUTE fromNode='oi' fromField='value_changed' toNode='trans2' toField='set_rotation'/>
        <ROUTE fromNode='oi' fromField='value_changed' toNode='trans1' toField='set_rotation'/>
        <ROUTE fromNode='oi' fromField='value_changed' toNode='transRT' toField='set_rotation'/>
      </Scene>
    </X3D>
	</div>
    <div class="group">    
	    <input type="button" value=" view1.set_bind "  onclick="document.getElementById('view1').setAttribute('set_bind','true');" />
		<input type="button" value=" view2.set_bind "  onclick="document.getElementById('view2').setAttribute('set_bind','true');" />
    </div>
  </body>
</html>